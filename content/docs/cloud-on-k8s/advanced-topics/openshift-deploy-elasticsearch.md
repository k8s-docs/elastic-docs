---
title: "带路由部署Elasticsearch实例 "
linkTitle: ""
weight: 1
---

Use the following code to create an Elasticsearch cluster elasticsearch-sample and a "passthrough" route to access it:

cat <<EOF | oc apply -n elastic -f -

# This sample sets up an Elasticsearch cluster with an OpenShift route

apiVersion: elasticsearch.k8s.elastic.co/v1
kind: Elasticsearch
metadata:
name: elasticsearch-sample
spec:
version: 7.8.1
nodeSets:

- name: default
  count: 1
  config:
  node.master: true
  node.data: true
  node.ingest: true
  node.store.allow_mmap: false

---

apiVersion: route.openshift.io/v1
kind: Route
metadata:
name: elasticsearch-sample
spec:
#host: elasticsearch.example.com # override if you don't want to use the host that is automatically generated by OpenShift (<route-name>[-<namespace>].<suffix>)
tls:
termination: passthrough # Elasticsearch is the TLS endpoint
insecureEdgeTerminationPolicy: Redirect
to:
kind: Service
name: elasticsearch-sample-es-http
EOF
Elasticsearch pluginsedit
Note that Elasticsearch plugins cannot be installed at runtime in most OpenShift environments. This is because the plugin installer must run as root, but Elasticsearch is restricted from running as root. To add plugins to Elasticsearch, you can use custom images as described in Create custom images.
